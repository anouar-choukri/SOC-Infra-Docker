#mkdir -p cortex thehive && touch cortex/application.conf thehive/application.conf
#sudo nano cortex/application.conf
# copy-paste the following config :

# Secret key
play.http.secret.key="5jU6h1euT1jMJt3uCe3fbO2iGcoXOkF97XESPxkALivHblLd3vw8Vh4rJYpfL2wXcc"

# HTTP configuration
http.address=0.0.0.0
http.port=9001

# Akka configuration
akka {
  cluster.enable = off
  actor {
    provider = local
  }
}

# ElasticSearch configuration
search {
  index = cortex
  # Name of the index
  uri = "http://elasticsearch:9200/"
}

# Cache configuration
cache.job = 10 minutes
cache.user = 5 minutes
cache.organization = 5 minutes

job {
  runner = [docker]
}

# Docker job runner configuration
dockerJobRunner {
  # Directory where job files are located
  directory = /tmp/cortex-jobs
  # Docker image timeout
  timeout = 30 minutes
  # Path to the docker executable
  dockerExecutable = "docker"
}

analyzer {
  config {
    # HTTP proxy configuration
    # proxy.host = proxy.example.com
    # proxy.port = 3128
    
    # HTTPS proxy configuration  
    # proxy.https.host = proxy.example.com
    # proxy.https.port = 3128
    
    # Proxy authentication
    # proxy.auth.username = username
    # proxy.auth.password = password
    
    # Ignore proxy for these hosts
    # proxy.nonProxyHosts = ["localhost", "127.0.0.1"]
  }
  
  # Analyzer timeouts
  timeout = 120 seconds
  
  # Fork join pool for analyzers
  fork-join-executor {
    parallelism-factor = 2.0
    parallelism-max = 4
  }
}

# Authentication configuration
auth {
  provider = [local]
  
  # Multi-factor authentication
  multifactor = [totp]
  
  # Session timeout
  session.warning = 5m
  session.inactivity = 1h
}

# Datastore configuration
datastore {
  name = data
  # Size of stored files
  chunksize = 1m
  hash {
    main = "SHA-256"
    extra = ["SHA-1", "MD5"]
  }
  attachment.password = "malware"
}

# Maximum textual content length
play.http.parser.maxMemoryBuffer = 1M
play.http.parser.maxDiskBuffer = 1G

